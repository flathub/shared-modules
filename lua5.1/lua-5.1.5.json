{
    "name": "lua-5.1",
    "sources": [
        {
            "type": "archive",
            "url": "https://www.lua.org/ftp/lua-5.1.5.tar.gz",
            "sha256": "2640fc56a795f29d28ef15e13c34a47e223960b0240e8cb0a82d9b0738695333"
        },
        {
            "type": "patch",
            "path": "lua-5.1.5-cflags.patch"
        },
        {
            "type": "patch",
            "path": "lua-5.1.5-prefix.patch"
        },
        {
            "type": "patch",
            "path": "lua-5.1.5-so.patch"
        },
        {
            "type": "shell",
            "commands": [
                "sed -e 's:llua:llua5.1:' -e 's:/include:/include/lua5.1:' -i etc/lua.pc",
                "sed -r -e '/^LUA_(SO|A|T)=/ s/lua/lua5.1/' -e '/^LUAC_T=/ s/luac/luac5.1/' -i src/Makefile",
                "mv doc/lua.1 doc/lua5.1.1",
                "mv doc/luac.1 doc/luac5.1.1"
            ]
        }
    ],
    "cleanup": [
        "/bin",
        "/include",
        "/lib/*.a",
        "/lib/*.la",
        "/lib/pkgconfig",
        "/share/man"
    ],
    "buildsystem": "simple",
    "build-commands": [
        "make CFLAGS='-O2 -Wall -fPIC' linux",
        "make TO_BIN='lua5.1 luac5.1' TO_LIB='liblua5.1.a liblua5.1.so liblua5.1.so.5.1 liblua5.1.so.5.1.5' INSTALL_TOP='/app' INSTALL_INC='/app/include/lua5.1' TO_MAN='lua5.1.1 luac5.1.1' INSTALL_MAN='/app/share/man/man1' install",
        "install -Dm0644 etc/lua.pc /app/lib/pkgconfig/lua51.pc",
        "ln -s liblua5.1.so /app/lib/liblua.so.5.1",
        "ln -s liblua5.1.so /app/lib/liblua.so.5.1.5"
    ]
}
